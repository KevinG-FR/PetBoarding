@let prestations = filteredPrestations();

<div class="prestations-list">
  <!-- État de chargement -->
  @if (isLoading()) {
    <div class="loading-state text-center py-5">
      <mat-spinner diameter="50" color="primary"></mat-spinner>
      <p class="mt-3 text-muted">Chargement des prestations...</p>
    </div>
  }

  <!-- État d'erreur -->
  @else if (error()) {
    <div class="error-state text-center py-5">
      <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
      <h3 class="mt-3">Erreur de chargement</h3>
      <p class="text-muted">{{ error() }}</p>
      <button class="btn btn-primary mt-3" (click)="onRetry()">
        <mat-icon>refresh</mat-icon>
        Réessayer
      </button>
    </div>
  }

  <!-- Pas de résultats -->
  @else if (!hasResults()) {
    <div class="no-results">
      <div class="no-results-content">
        <mat-icon class="no-results-icon">search_off</mat-icon>
        <h3>Aucune prestation trouvée</h3>
        <p>Essayez de modifier vos critères de recherche ou de filtrage.</p>
      </div>
    </div>
  }

  <!-- Liste des prestations -->
  @else {
    <div class="row g-4">
      @for (prestation of prestations; track prestation.id) {
        <div class="col-lg-4 col-md-6 col-sm-12">
          <app-prestation-item [prestation]="prestation" (viewDetails)="onViewDetails($event)" />
        </div>
      }
    </div>
  }

  <!-- Statistiques (seulement si pas en état de chargement ou d'erreur) -->
  @if (!isLoading() && !error()) {
    <div class="results-summary mt-4">
      <small class="text-muted">
        {{ resultCount() }}
        prestation{{ resultCount() > 1 ? 's' : '' }}
        @if (isFiltered()) {
          sur {{ totalCount() }}
        }
      </small>
    </div>
  }
</div>
