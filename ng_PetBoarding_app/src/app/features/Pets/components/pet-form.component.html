<div class="pet-form-container bg-light min-vh-100">
  <div class="container-fluid py-4">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-8 col-xl-6">
        <mat-card class="shadow-sm border-0">
          <mat-card-header class="pb-3">
            <div class="d-flex align-items-center w-100">
              <mat-icon class="me-3 text-primary">pets</mat-icon>
              <mat-card-title class="mb-0">
                {{ isEditMode() ? 'Modifier ' + pet?.name : 'Ajouter un animal' }}
              </mat-card-title>
            </div>
          </mat-card-header>

          <mat-card-content>
            <form [formGroup]="petForm" (ngSubmit)="onSubmit()" novalidate>
              <!-- Informations de base -->
              <div class="row mb-4">
                <div class="col-12">
                  <h6 class="fw-bold text-muted mb-3">
                    <mat-icon class="me-2" style="font-size: 1.1rem">info</mat-icon>
                    Informations de base
                  </h6>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Nom de l'animal</mat-label>
                    <input matInput formControlName="name" placeholder="Ex: Rex" />
                    <mat-icon matSuffix>pets</mat-icon>
                    @if (getFieldError('name')) {
                      <mat-error>{{ getFieldError('name') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Type d'animal</mat-label>
                    <mat-select formControlName="type">
                      @for (type of petTypes; track type) {
                        <mat-option [value]="type">
                          {{ petTypeLabels[type] }}
                        </mat-option>
                      }
                    </mat-select>
                    @if (getFieldError('type')) {
                      <mat-error>{{ getFieldError('type') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Race</mat-label>
                    <input matInput formControlName="breed" placeholder="Ex: Labrador" />
                    @if (getFieldError('breed')) {
                      <mat-error>{{ getFieldError('breed') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Âge (années)</mat-label>
                    <input matInput type="number" formControlName="age" min="0" max="30" />
                    @if (getFieldError('age')) {
                      <mat-error>{{ getFieldError('age') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Poids (kg) - Optionnel</mat-label>
                    <input matInput type="number" formControlName="weight" min="0" step="0.1" />
                    @if (getFieldError('weight')) {
                      <mat-error>{{ getFieldError('weight') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Couleur</mat-label>
                    <input matInput formControlName="color" placeholder="Ex: Marron et blanc" />
                    @if (getFieldError('color')) {
                      <mat-error>{{ getFieldError('color') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 col-md-6 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Sexe</mat-label>
                    <mat-select formControlName="gender">
                      @for (gender of petGenders; track gender) {
                        <mat-option [value]="gender">
                          {{ petGenderLabels[gender] }}
                        </mat-option>
                      }
                    </mat-select>
                    @if (getFieldError('gender')) {
                      <mat-error>{{ getFieldError('gender') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 mb-3">
                  <mat-checkbox formControlName="isNeutered" class="text-muted">
                    Animal stérilisé/castré
                  </mat-checkbox>
                </div>
              </div>

              <!-- Informations supplémentaires -->
              <div class="row mb-4">
                <div class="col-12">
                  <h6 class="fw-bold text-muted mb-3">
                    <mat-icon class="me-2" style="font-size: 1.1rem">medical_services</mat-icon>
                    Informations supplémentaires
                  </h6>
                </div>

                <div class="col-12 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Numéro de puce électronique - Optionnel</mat-label>
                    <input
                      matInput
                      formControlName="microchipNumber"
                      placeholder="Ex: 123456789012345" />
                    <mat-icon matSuffix>memory</mat-icon>
                    @if (getFieldError('microchipNumber')) {
                      <mat-error>{{ getFieldError('microchipNumber') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Notes médicales - Optionnel</mat-label>
                    <textarea
                      matInput
                      formControlName="medicalNotes"
                      rows="3"
                      placeholder="Allergies, traitements en cours, historique médical..."></textarea>
                    @if (getFieldError('medicalNotes')) {
                      <mat-error>{{ getFieldError('medicalNotes') }}</mat-error>
                    }
                  </mat-form-field>
                </div>

                <div class="col-12 mb-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Besoins spéciaux - Optionnel</mat-label>
                    <textarea
                      matInput
                      formControlName="specialNeeds"
                      rows="3"
                      placeholder="Régime alimentaire spécial, exercices particuliers, anxiété..."></textarea>
                    @if (getFieldError('specialNeeds')) {
                      <mat-error>{{ getFieldError('specialNeeds') }}</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>

              <!-- Actions -->
              <div class="d-flex justify-content-end gap-3 mt-4">
                <button
                  type="button"
                  mat-stroked-button
                  (click)="onCancel()"
                  [disabled]="isLoading">
                  <mat-icon class="me-2">close</mat-icon>
                  Annuler
                </button>
                <button type="submit" mat-raised-button color="primary" [disabled]="isLoading">
                  @if (isLoading) {
                    <mat-spinner diameter="20" class="me-2"></mat-spinner>
                  } @else {
                    <mat-icon class="me-2">save</mat-icon>
                  }
                  {{ isEditMode() ? 'Modifier' : 'Ajouter' }}
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>
